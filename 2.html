<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. 요즘 내 마음의 날씨는?</title>
  <!-- 공통 CSS 파일 연결 -->
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* 페이지별 추가 스타일 (필요시 수정) */
    .question {
      margin-bottom: 30px;
    }
    .choice {
      display: block;
      margin: 10px 0;
      padding: 12px;
      width: 100%;
      max-width: 300px;
      font-size: 16px;
      border: 2px solid #333;
      border-radius: 8px;
      cursor: pointer;
      background: #fff;
      text-align: left;
    }
    .choice:hover {
      background-color: #f0f0f0;
    }
    #result {
      text-align: center;
    }
    #result h2 {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }
    #result p {
      margin-bottom: 20px;
    }
    #result button {
      margin: 5px;
      padding: 10px 16px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      background-color: #4CAF50;
      color: #fff;
      transition: background-color 0.2s;
    }
    #result button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <header>
    <h1>요즘 내 마음의 날씨는?</h1>
    <a href="index.html">← 테스트 목록으로 돌아가기</a>
  </header>

  <main>
    <!-- 질문 1 -->
    <section id="q1" class="question">
      <p><strong>Q1. 오늘 기분이 가장 잘 드러나는 한마디는?</strong></p>
      <button class="choice" data-score="sunny">A. “오늘은 모든 게 잘 풀릴 것 같아!”</button>
      <button class="choice" data-score="cloudy">B. “그냥 무던하게 보내고 싶어.”</button>
      <button class="choice" data-score="rainy">C. “왠지 마음이 울적해…”</button>
      <button class="choice" data-score="stormy">D. “머릿속이 복잡해서 폭풍 같아!”</button>
    </section>

    <!-- 질문 2 -->
    <section id="q2" class="question" style="display: none;">
      <p><strong>Q2. 스트레스를 받을 때 주로 하는 행동은?</strong></p>
      <button class="choice" data-score="sunny">A. 친구와 웃으며 수다 떨기</button>
      <button class="choice" data-score="cloudy">B. 조용히 음악 들으며 쉬기</button>
      <button class="choice" data-score="rainy">C. 혼자 조용히 눈물 흘리기</button>
      <button class="choice" data-score="stormy">D. 격하게 운동하거나 질러버리기</button>
    </section>

    <!-- 질문 3 -->
    <section id="q3" class="question" style="display: none;">
      <p><strong>Q3. 이상적인 힐링 방법은?</strong></p>
      <button class="choice" data-score="sunny">A. 야외 나들이하며 산책하기</button>
      <button class="choice" data-score="cloudy">B. 따뜻한 차 한 잔과 책 읽기</button>
      <button class="choice" data-score="rainy">C. 감성 영화 보며 눈물 흘리기</button>
      <button class="choice" data-score="stormy">D. 신나는 음악 크게 틀고 춤추기</button>
    </section>

    <!-- 결과 보여줄 섹션 -->
    <section id="result" style="display: none;">
      <!-- JavaScript로 결과 채워질 예정 -->
    </section>
  </main>

  <footer>
    <p>© 2025 MyPsychTest</p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const choices = document.querySelectorAll('.choice');
      const questions = document.querySelectorAll('.question');
      let answers = [];

      choices.forEach(btn => {
        btn.addEventListener('click', (e) => {
          // 답변 점수(날씨 코드) 저장
          const weatherType = e.target.getAttribute('data-score');
          answers.push(weatherType);

          // 현재 질문 숨기고 다음 질문 표시
          const currentSection = e.target.closest('.question');
          const nextSection = currentSection.nextElementSibling;
          if (nextSection && nextSection.classList.contains('question')) {
            currentSection.style.display = 'none';
            nextSection.style.display = 'block';
          } else {
            // 마지막 질문이 끝나면 결과 표시
            showResult(answers);
          }
        });
      });

      function showResult(arr) {
        // 각 날씨 코드별 빈도 계산
        const counts = arr.reduce((acc, cur) => {
          acc[cur] = (acc[cur] || 0) + 1;
          return acc;
        }, {});

        // 가장 많이 선택된 날씨 타입 찾기
        let maxType = 'sunny';
        let maxCount = 0;
        Object.keys(counts).forEach(type => {
          if (counts[type] > maxCount) {
            maxCount = counts[type];
            maxType = type;
          }
        });

        // 날씨별 결과 텍스트 및 설명
        let resultTitle = '';
        let resultDesc = '';
        switch (maxType) {
          case 'sunny':
            resultTitle = '☀️ 맑음';
            resultDesc = '지금 당신의 마음은 기분 좋고 밝은 햇살처럼 맑아요! 새로운 도전도 두렵지 않답니다.';
            break;
          case 'cloudy':
            resultTitle = '☁️ 흐림';
            resultDesc = '요즘 당신의 마음은 구름 낀 하늘 같아요. 큰 기복 없이 무난하지만, 가끔은 차분한 휴식이 필요해요.';
            break;
          case 'rainy':
            resultTitle = '🌧️ 비';
            resultDesc = '지금 당신의 마음은 잔잔한 빗방울처럼 촉촉하고 감성적이에요. 가끔 울적해도 괜찮아요. 감정을 표현할 시간이 필요해요.';
            break;
          case 'stormy':
            resultTitle = '⛈️ 폭풍';
            resultDesc = '지금 당신의 마음은 폭풍이 몰아치는 것처럼 복잡해요. 스트레스가 최고조에 달해있을 수 있어요. 잠시 멈추고 숨 고를 필요가 있어요.';
            break;
        }

        // 결과 섹션에 내용 삽입
        const resSection = document.getElementById('result');
        resSection.innerHTML = `
          <h2>결과: ${resultTitle}</h2>
          <p>${resultDesc}</p>
          <button id="retry">다시 하기</button>
          <button id="toIndex">테스트 목록으로</button>
        `;

        // 모든 질문 숨기기
        questions.forEach(sec => sec.style.display = 'none');
        // 결과 섹션 표시
        resSection.style.display = 'block';

        // 버튼 이벤트 연결
        document.getElementById('retry').addEventListener('click', () => {
          location.href = '2.html';
        });
        document.getElementById('toIndex').addEventListener('click', () => {
          location.href = 'index.html';
        });
      }
    });
  </script>
</body>
</html>
